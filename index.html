<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ARis הדמיית צמח בבית</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      position: relative;
    }

    video {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: 1;
    }

    #plant-overlay {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 50%;
      z-index: 2;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <video id="camera" autoplay playsinline></video>
  <img id="plant-overlay" src="plant-in-pot.png" alt="צמח לדוגמה" />

<script>
  const video = document.getElementById('camera');

  function stopCamera() {
    if (video.srcObject) {
      video.srcObject.getTracks().forEach(track => track.stop());
      video.srcObject = null;
    }
  }

  function startCamera() {
    stopCamera(); // קודם עוצרים כל זרם קודם

    navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
      .then((stream) => {
        video.srcObject = stream;
      })
      .catch((err) => {
        alert('לא הצלחנו לגשת למצלמה: ' + err.message);
      });
  }

  // הפעלת מצלמה כשהעמוד עולה
  window.addEventListener('load', startCamera);

  // הפעלת מצלמה מחדש אם חזרנו לטאב
  document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'visible') {
      startCamera();
    }
  });
</script>


</body>
</html>
